# Insights Operator Gathered Data

This document is auto-generated by `make docs`, and details what 
data Insights Operator (IO) gathers from a cluster, the location 
where it is stored in the IO archive, and the applicable version(s) of OpenShift. 
Data stored in the `conditional/` directory is only 
gathered when certain conditions are met.

The IO pod operates in the `openshift-insights` namespace and the 
archives are packaged as `.tar.gz` files in `/var/lib/insights-operator`.

***

## APIRequestCounts

BuildGatherApiRequestCounts creates a gathering closure which collects API requests counts for the
resources mentioned in the alert provided as a string parameter
Params is of type AlertIsFiringConditionParams:
  - alert_name string - name of the firing alert

* Location in archive: conditional/alerts/{alert_name}/api_request_counts.json
* Id in config: conditional/api_request_counts_of_resource_from_alert
* Since versions:
  - 4.10+


## ActiveAlerts

Collects active alerts from the Alertmanager API V2 in the JSON format. Alert data is also
still included in the [GatherMostRecentMetrics](#mostrecentmetrics) gatherer.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/alerts.json](./insights-archive-sample/config/alerts.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.12   | config/alerts.json				                        	|

### Config ID
`clusterconfig/active_alerts`

### Released version
- 4.12

### Backported versions
None

### Notes
This adds new gatherer for gathering firing/active Prometheus alerts in JSON format as well. The original recent
metrics gatherer still continues to gather the alerts (not in JSON) as well, but this can be removed in the future,
and we will keep the data only in JSON.


## CRD

collects the specified Custom Resource Definitions.

The following CRDs are gathered:
- volumesnapshots.snapshot.storage.k8s.io (10745 bytes)
- volumesnapshotcontents.snapshot.storage.k8s.io (13149 bytes)

The CRD sizes above are in the raw (uncompressed) state.

* Location in archive: config/crd/
* Id in config: clusterconfig/crds


## CephCluster

Collects statuses of the`cephclusters.ceph.rook.io` resources
from Openshift Data Foundation Stack.

### API Reference
- https://github.com/rook/rook/blob/master/pkg/apis/ceph.rook.io/v1/types.go

### Sample data
- [docs/insights-archive-sample/config/storage/openshift-storage/cephclusters/ocs-storagecluster-cephcluster.json](./insights-archive-sample/config/storage/openshift-storage/cephclusters/ocs-storagecluster-cephcluster.json)

### Location in archive
| Version | Path													 |
| ------- | ----------------------------------------------------- |
| <= 4.12 | config/storage/{namespace}/{name}.json 				 |
| 4.13+   | config/storage/{namespace}/cephclusters/{name}.json 	 |

### Config ID
`clusterconfig/ceph_cluster`

### Released version
- 4.12

### Backported versions
- 4.8.49+
- 4.9.48+
- 4.10.31+
- 4.11.2+

### Notes
None


## CertificateSigningRequests

Collects anonymized CertificateSigningRequests which weren't Verified, or
when Now < ValidBefore or Now > ValidAfter

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/certificates/v1beta1/certificatesigningrequest.go#L78
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#certificatesigningrequestlist-v1beta1certificates

### Sample data
- [docs/insights-archive-sample/config/storage/openshift-storage/ocs-storagecluster-cephcluster.json](./insights-archive-sample/config/storage/openshift-storage/ocs-storagecluster-cephcluster.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.5    | config/certificatesigningrequests 					        |

### Config ID
`clusterconfig/certificate_signing_requests`

### Released version
- 4.5

### Backported versions
- 4.3.25+
- 4.4.12+

### Notes
None


## ClusterAuthentication

Collects the cluster Authentication - the Authentication with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/authentication.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#authentication-v1operator-openshift-io

### Sample data
- [docs/insights-archive-sample/config/authentication.json](./insights-archive-sample/config/authentication.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/authentication.json 								|

### Config ID
`clusterconfig/authentication`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterFeatureGates

Collects the cluster FeatureGate - the FeatureGate with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/featuregate.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#featuregate-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/featuregate.json](./insights-archive-sample/config/featuregate.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/featuregate.json 					                |

### Config ID
`clusterconfig/feature_gates`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterImage

Collects cluster `images.config.openshift.io` resource definition.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/config_client.go#L72
- https://docs.openshift.com/container-platform/latest/rest_api/config_apis/image-config-openshift-io-v1.html#image-config-openshift-io-v1

### Sample data
- [docs/insights-archive-sample/config/image.json](./insights-archive-sample/config/image.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| > 4.11    | config/image.json					                        |

### Config ID
`clusterconfig/image`

### Released version
- 4.11

### Backported versions
- 4.10.8+

### Notes
None


## ClusterImagePruner

Collects the image pruner configuration.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/clusteroperator/imageregistry.operator.openshift.io/imagepruner/cluster.json](./insights-archive-sample/clusteroperator/imageregistry.operator.openshift.io/imagepruner/cluster.json)

### Location in archive
| Version   | Path																			     |
| --------- | ----------------------------------------------------------------------------------- |
| <= 4.5    | config/imagepruner.json														 	 |
| >= 4.6    | config/clusteroperator/{group}/{kind}/{name}.json |

### Config ID
`clusterconfig/image_pruners`

### Released version
- 4.5

### Backported versions
None

### Notes
None


## ClusterImageRegistry

fetches the cluster Image Registry configuration

**Conditional data**: If the Image Registry configuration uses any PersistentVolumeClaim for the storage, the corresponding
PersistentVolume definition is gathered

* Location in archive: config/clusteroperator/imageregistry.operator.openshift.io/config/cluster.json
* Location in older versions: config/imageregistry.json
* Id in config: clusterconfig/image_registries
* Since versions:
  - 4.3.40+
  - 4.4.12+
  - 4.5+

* PV definition since versions:
  - 4.6.20+
  - 4.7+


## ClusterInfrastructure

Collects the cluster Infrastructure - the Infrastructure with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/infrastructure.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#infrastructure-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/infrastructure/.json](./insights-archive-sample/config/infrastructure/.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/infrastructure.json 					            |

### Config ID
`clusterconfig/infrastructures`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterIngress

Collects the cluster Ingress - the Ingress with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/ingress.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#ingress-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/ingress.json](./insights-archive-sample/config/ingress.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/ingress.json 					                    |

### Config ID
`clusterconfig/ingress`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterNetwork

Collects the cluster Network - the Network with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/network.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#network-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/.json](./insights-archive-sample/config/.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/network.json 					                    |

### Config ID
`clusterconfig/networks`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterOAuth

Collects the cluster OAuth - the OAuth with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/oauth.go#L50
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#oauth-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/oauth.json](./insights-archive-sample/config/oauth.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/oauth.json 					                        |

### Config ID
`clusterconfig/oauths`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## ClusterOperatorPodsAndEvents

collects information about pods
and events from namespaces of degraded cluster operators. The collected
information includes:

- Definitions for non-running (terminated, pending) Pods
- Previous (if container was terminated) and current logs of all related pod containers
- Namespace events

  - Location of pod definitions: config/pod/{namespace}/{pod}.json
  - Location of pod container current logs:
    config/pod/{namespace}/logs/{pod}/{container}_current.log
  - Location of pod container previous logs:
    config/pod/{namespace}/logs/{pod}/{container}_previous.log
  - Location of events in archive: events/
  - Id in config: clusterconfig/operators_pods_and_events
  - Spec config for CO resources since versions:
  - 4.6.16+
  - 4.7+


## ClusterOperators

collects all the ClusterOperators definitions and their related resources
from the `operator.openshift.io` group.

The Kubernetes api https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/clusteroperator.go#L62
Response see https://docs.openshift.com/container-platform/4.3/rest_api/index.html#clusteroperatorlist-v1config-openshift-io

* Location of operators related resources: config/clusteroperator/{group}/{kind}/{name}
* Location of operators in archive: config/clusteroperator/
* Location of operators related resources in older versions: config/clusteroperator/{kind}-{name}
* See: [docs/insights-archive-sample/config/clusteroperator](./insights-archive-sample/config/clusteroperator)
* Id in config: clusterconfig/operators
* Spec config for CO resources since versions:
  - 4.6.16+
  - 4.7+


## ClusterProxy

Collects the cluster Proxy - the Proxy with name cluster.

### API Reference
- https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/proxy.go#L30
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#proxy-v1-config-openshift-io

### Sample data
- [docs/insights-archive-sample/config/proxy.json](./insights-archive-sample/config/proxy.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.3    | config/proxy.json 					                        |

### Config ID
`clusterconfig/proxies`

### Released version
- 4.3

### Backported versions
None

### Notes
None


## ClusterVersion

fetches the ClusterVersion (including the cluster ID) with the name 'version' and its resources.

The Kubernetes api https://github.com/openshift/client-go/blob/master/config/clientset/versioned/typed/config/v1/clusterversion.go#L50
Response see https://docs.openshift.com/container-platform/4.3/rest_api/index.html#clusterversion-v1config-openshift-io

* Location in archive: config/version/
* See: [docs/insights-archive-sample/config/version](./insights-archive-sample/config/version)
* Location of pods in archive: config/pod/
* Location of events in archive: events/
* Location of cluster ID: config/id
* See: [docs/insights-archive-sample/config/id](./insights-archive-sample/config/id)
* Id in config: clusterconfig/version


## ConfigMaps

fetches the ConfigMaps from namespace openshift-config
and tries to fetch "cluster-monitoring-config" ConfigMap from openshift-monitoring namespace.

Anonymization: If the content of ConfigMap contains a parseable PEM structure (like certificate) it removes the inside of PEM blocks.
For ConfigMap of type BinaryData it is encoded as standard base64.
In the archive under configmaps we store name of the namespace, name of the ConfigMap and then each ConfigMap Key.
For example config/configmaps/NAMESPACENAME/CONFIGMAPNAME/CONFIGMAPKEY1

The Kubernetes api https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/configmap.go#L80
Response see https://docs.openshift.com/container-platform/4.3/rest_api/index.html#configmaplist-v1core

* Location in archive: config/configmaps/{namespace-name}/{configmap-name}/
* Location in older versions: config/configmaps/{configmap-name}/
* See: [docs/insights-archive-sample/config/configmaps](./insights-archive-sample/config/configmaps)
* Id in config: clusterconfig/config_maps
* Since versions:
  - 4.3.25+
  - 4.4.6+
  - 4.5+

* "cluster-monitoring-config" ConfigMap data since versions:
  - 4.6.22+
  - 4.7+

* "cluster-config-v1" ConfigMap since versions:
  - 4.9+


## ContainerImages

collects essential information about running containers.
Specifically, the age of pods, the set of running images and the container names are collected.

* Location in archive: config/running_containers.json
* Id in config: clusterconfig/container_images
* Since versions:
  - 4.5.33+
  - 4.6.16+
  - 4.7+


## ContainerRuntimeConfig

collects ContainerRuntimeConfig  information

The Kubernetes api:

	https://github.com/openshift/machine-config-operator/blob/master/pkg/apis/machineconfiguration.openshift.io/v1/types.go#L402

Response see:

	https://docs.okd.io/latest/rest_api/machine_apis/containerruntimeconfig-machineconfiguration-openshift-io-v1.html

* Location in archive: config/containerruntimeconfigs/
* Id in config: clusterconfig/container_runtime_configs
* Since versions:
  - 4.6.18+
  - 4.7+


## ContainersLogs

collects either current or previous containers logs for pods firing one of the configured alerts.

* Location in archive: conditional/namespaces/{namespace}/pods/{pod}/containers/{container}/{logs|logs-previous}/last-{tail-length}-lines.log
* Id in config: conditional/containers_logs
* Since versions:
  - 4.10+


## CostManagementMetricsConfigs

collects CostManagementMetricsConfigs definitions.
* Location in archive: config/cost_management_metrics_configs/{name}.json
* Id in config: clusterconfig/cost_management_metrics_configs
* Since versions:
  - 4.8.27+
  - 4.9.13+
  - 4.10+


## DVOMetrics

collects metrics from the Deployment Validation Operator's
metrics service. The metrics are fetched via the /metrics endpoint and
filtered to only include those with a deployment_validation_operator_ prefix.

* Location in archive: config/dvo_metrics
* See: [docs/insights-archive-sample/config/dvo_metrics](./insights-archive-sample/config/dvo_metrics)
* Id in config: clusterconfig/dvo_metrics
* Since version:
  - 4.10


## HostSubnet

collects HostSubnet information

The Kubernetes api https://github.com/openshift/client-go/blob/master/network/clientset/versioned/typed/network/v1/hostsubnet.go
Response see https://docs.openshift.com/container-platform/4.3/rest_api/index.html#hostsubnet-v1-network-openshift-io

* Location in archive: config/hostsubnet/
* Id in config: clusterconfig/host_subnets
* Since versions:
  - 4.4.29+
  - 4.5.15+
  - 4.6+


## ImageStreamsOfNamespace

creates a gathering closure which collects image streams from the provided namespace
Params is of type GatherImageStreamsOfNamespaceParams:
  - namespace string - namespace from which to collect image streams

API reference:

	https://docs.openshift.com/container-platform/4.7/rest_api/image_apis/imagestream-image-openshift-io-v1.html#apisimage-openshift-iov1namespacesnamespaceimagestreams

* Location in archive: conditional/namespaces/{namespace}/imagestreams/{name}
* Id in config: conditional/image_streams_of_namespace
* Since versions:
  - 4.9+


## InstallPlans

Collects top X InstallPlans from all openshift namespaces. Because InstallPlans have
unique generated names, it groups them by namespace and the "template" for name generation from field generateName.
It also collects Total number of all installplans and all non-unique installplans.

### API Reference
- https://github.com/operator-framework/api/blob/master/pkg/operators/v1alpha1/installplan_types.go#L26

### Sample data
- [docs/insights-archive-sample/config/instalplans.json](./insights-archive-sample/config/instalplans.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.7    | config/instalplans.json									|

### Config ID
`clusterconfig/install_plans`

### Released version
- 4.7

### Backported versions
- 4.5.33+
- 4.6.16+

### Notes
None


## JaegerCR

Collects maximum of 5 `jaegers.jaegertracing.io` custom resources installed in the cluster.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/jaegertracing.io/jaeger1.json](./insights-archive-sample/config/jaegertracing.io/jaeger1.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/.json 					                        	|

### Config ID
`clusterconfig/jaegers`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## KubeControllerManagerLogs

Collects ogs from kube-controller-manager pods in the
`openshift-kube-controller-manager` namespace with following substrings:
- "Internal error occurred: error resolving resource",
- "syncing garbage collector with updated resources from discovery",

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.10/rest_api/workloads_apis/pod-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
- [docs/insights-archive-sample/config/pod/openshift-kube-controller-manager/logs/kube-controller-manager-ip-10-0-168-11.us-east-2.compute.internal/errors.log](./insights-archive-sample/config/pod/openshift-kube-controller-manager/logs/kube-controller-manager-ip-10-0-168-11.us-east-2.compute.internal/errors.log)

### Location in archive
| Version   | Path																	 |
| --------- | ----------------------------------------------------------------------- |
|  >= 4.11  | config/pod/openshift-kube-controller-manager/logs/{pod-name}/errors.log |

### Config ID
`clusterconfig/kube_controller_manager_logs`

### Released version
- 4.11

### Backported versions
- 4.10.6+
- 4.9.27+

### Notes
None


## LogsOfNamespace

creates a gathering closure which collects logs from pods in the provided namespace
Params is of type GatherLogsOfNamespaceParams:
  - namespace string - namespace from which to collect logs
  - tail_lines int64 - a number of log lines to keep for each container

The Kubernetes API:

	https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48

Response see:

	https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

* Location in archive: conditional/namespaces/{namespace}/pods/{pod_name}/containers/{container_name}/logs/last-{n}-lines.log
* Id in config: conditional/logs_of_namespace
* Since versions:
  - 4.9+


## MachineAutoscalers

Collects MachineAutoscalers definition.

### API Reference
- https://github.com/openshift/cluster-autoscaler-operator/blob/master/pkg/apis/autoscaling/v1beta1/machineautoscaler_types.go
- https://docs.openshift.com/container-platform/4.7/rest_api/autoscale_apis/machineautoscaler-autoscaling-openshift-io-v1beta1.html#machineautoscaler-autoscaling-openshift-io-v1beta1

### Sample data
- [docs/insights-archive-sample/config/machineautoscalers/openshift-machine-api/worker-us-east-1a.json](./insights-archive-sample/config/machineautoscalers/openshift-machine-api/worker-us-east-1a.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8.2  | config/machineautoscalers/{namespace}/{resource}.json		|

### Config ID
`clusterconfig/machine_autoscalers`

### Released version
- 4.8.2

### Backported versions
None

### Notes
None


## MachineConfigPool

Collects MachineConfigPool information.

### API Reference
- https://github.com/openshift/machine-config-operator/blob/master/pkg/apis/machineconfiguration.openshift.io/v1/types.go#L197
- https://docs.okd.io/latest/rest_api/machine_apis/machineconfigpool-machineconfiguration-openshift-io-v1.html

### Sample data
- [docs/insights-archive-sample/config/machineconfigpools](./insights-archive-sample/config/machineconfigpools)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.7    | config/machineconfigpools 									|

### Config ID
`clusterconfig/machine_config_pools`

### Released version
- 4.7

### Backported versions
- 4.5.33+
- 4.6.16+

### Notes
None


## MachineConfigs

Collects MachineConfigs definitions. Following data is intentionally removed from the definitions:
- `spec.config.storage.files`
- `spec.config.passwd.users`

### API Reference
- https://docs.openshift.com/container-platform/4.7/rest_api/machine_apis/machineconfig-machineconfiguration-openshift-io-v1.html

### Sample data
- [docs/insights-archive-sample/config/machineconfigs/75-worker-sap-data-intelligence.json](./insights-archive-sample/config/machineconfigs/75-worker-sap-data-intelligence.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8.2  | config/machineconfigs/{resource}.json 							|

### Config ID
`clusterconfig/machine_configs`

### Released version
- 4.8.2

### Backported versions
None

### Notes
None


## MachineHealthCheck

Collects MachineHealthCheck information.

### API Reference
- https://github.com/openshift/api/blob/master/machine/v1beta1/types_machinehealthcheck.go
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#machinehealthcheck-v1beta1-machine-openshift-io

### Sample data
- [docs/insights-archive-sample/config/machinehealthchecks/openshift-machine-api/machine-api-termination-handler.json](./insights-archive-sample/config/machinehealthchecks/openshift-machine-api/machine-api-termination-handler.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8    | config/machinehealthchecks/{namespace}/{resource}.json 	|

### Config ID
`clusterconfig/machine_healthchecks`

### Released version
- 4.8

### Backported versions
None

### Notes
None


## MachineSet

Collects MachineSet information.

### API Reference
- https://github.com/openshift/api/blob/master/machine/v1beta1/types_machineset.go
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#machineset-v1beta1-machine-openshift-io

### Sample data
- [docs/insights-archive-sample/d50d0126-c90b-4428-a75f-dc08cd02960a-worker-test](./insights-archive-sample/d50d0126-c90b-4428-a75f-dc08cd02960a-worker-test)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.6    | config//machinesets/{resource}								|

### Config ID
`clusterconfig/machine_sets`

### Released version
- 4.6

### Backported versions
- 4.4.29+
- 4.5.15+

### Notes
None


## MostRecentMetrics

gathers cluster Federated Monitoring metrics.

The GET REST query to URL /federate
Gathered metrics:

	virt_platform
	etcd_object_counts
	cluster_installer
	vsphere_node_hw_version_total
	namespace CPU and memory usage
	console_helm_installs_total
	console_helm_upgrades_total
	console_helm_uninstalls_total
	followed by at most 1000 lines of ALERTS metric

* Location in archive: config/metrics
* See: [docs/insights-archive-sample/config/metrics](./insights-archive-sample/config/metrics)
* Id in config: clusterconfig/metrics
* Since version:
  - "etcd_object_counts": 4.3+
  - "cluster_installer": 4.3+
  - "ALERTS": 4.3+
  - "namespace:container_cpu_usage_seconds_total:sum_rate": 4.5+
  - "namespace:container_memory_usage_bytes:sum": 4.5+
  - "virt_platform metric": 4.6.34+, 4.7.16+, 4.8+
  - "vsphere_node_hw_version_total": 4.7.11+, 4.8+
  - "console_helm_installs_total": 4.11+
  - "console_helm_upgrades_total": 4.12+
  - "console_helm_uninstalls_total": 4.12+


## MutatingWebhookConfigurations

Collects MutatingWebhookConfiguration resources.

### API Reference
- https://docs.openshift.com/container-platform/4.8/rest_api/extension_apis/mutatingwebhookconfiguration-admissionregistration-k8s-io-v1.html

### Sample data
- [docs/insights-archive-sample/config/mutatingwebhookconfigurations](./insights-archive-sample/config/mutatingwebhookconfigurations)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/mutatingwebhookconfigurations/{resource}.json 		|

### Config ID
`clusterconfig/mutating_webhook_configurations`

### Released version
- 4.10.13

### Backported versions
- 4.7.40+
- 4.8.24+
- 4.9.11+

### Notes
None


## NamespacesWithOverlappingUIDs

gathers namespaces with overlapping UID ranges

The Kubernetes api https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/namespace.go
Response is an array of arrays of namespaces with overlapping UIDs. Each namespace is represented by its name and the UID range value
from the "openshift.io/sa.scc.uid-range" annotation

* Location in archive: config/namespaces_with_overlapping_uids
* Id in config: clusterconfig/overlapping_namespace_uids
* Since versions:
  - 4.8.41
  - 4.9.31
  - 4.10.12
  - 4.11+


## NetNamespace

Collects NetNamespaces networking information.

### API Reference
- https://github.com/openshift/client-go/blob/master/network/clientset/versioned/typed/network/v1/netnamespace.go

### Sample data
- [docs/insights-archive-sample/config/netnamespaces.json](./insights-archive-sample/config/netnamespaces.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.7    | config/netnamespaces.json				                    |

### Config ID
`clusterconfig/netnamespaces`

### Released version
- 4.7

### Backported versions
- 4.6.20+

### Notes
None


## NodeLogs

Collects control plane node logs from journal unit.

### API Reference
- https://docs.openshift.com/container-platform/4.9/rest_api/node_apis/node-core-v1.html#apiv1nodesnameproxypath

### Sample data
- [docs/insights-archive-sample/config/nodes/logs](./insights-archive-sample/config/nodes/logs)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/nodes/logs/{hostname}.log							|

### Config ID
`clusterconfig/node_logs`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## Nodes

Collects all cluster nodes.

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/node.go#L78
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#nodelist-v1core

### Sample data
- [docs/insights-archive-sample/config/node](./insights-archive-sample/config/node)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.2    | config/node/{node}.json									|

### Config ID
`clusterconfig/nodes`

### Released version
- 4.2

### Backported versions
None

### Notes
None


## OLMOperators

Collects the list of installed OLM operators. Each OLM operator (in the list) contains
following data:
- OLM operator name
- OLM operator version
- related ClusterServiceVersion conditions

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/olm_operators](./insights-archive-sample/config/olm_operators)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.7    | config/olm_operators 					                    |

### Config ID
`clusterconfig/olm_operators`

### Released version
- 4.7

### Backported versions
- 4.6.26+

### Notes
None


## OpenShiftAPIServerOperatorLogs

Collects logs from `openshift-apiserver-operator` with following substrings:
- "the server has received too many requests and has asked us"
- "because serving request timed out and response had been started"

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
- [docs/insights-archive-sample/config/pod/openshift-apiserver-operator/logs/openshift-apiserver-operator-6ddb679b87-4kn55/errors.log](./insights-archive-sample/config/pod/openshift-apiserver-operator/logs/openshift-apiserver-operator-6ddb679b87-4kn55/errors.log)

### Location in archive
| Version   | Path													 	|
| --------- | ---------------------------------------------------------- |
| >= 4.7    | config/pod/{namespace-name}/logs/{pod-name}/errors.log   	|

### Config ID
`clusterconfig/openshift_apiserver_operator_logs`

### Released version
- 4.7

### Backported versions
None

### Notes
None


## OpenshiftAuthenticationLogs

Collects logs from pods in `openshift-authentication` namespace with following
substring:
- "AuthenticationError: invalid resource name"

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
- [docs/insights-archive-sample/config/pod/openshift-authentication/logs/oauth-openshift-6c98668d5b-ftt5n/errors.log](./insights-archive-sample/config/pod/openshift-authentication/logs/oauth-openshift-6c98668d5b-ftt5n/errors.log)

### Location in archive
| Version   | Path															|
| --------- | -------------------------------------------------------------- |
| >= 4.7    | config/pod/openshift-authentication/logs/{pod-name}/errors.log |

### Config ID
`clusterconfig/openshift_authentication_logs`

### Released version
- 4.7

### Backported versions
None

### Notes
None


## OpenshiftLogging

Collects `logging.openshift.io` resources
from Openshift Logging Stack.

### API Reference
- https://github.com/openshift/cluster-logging-operator/blob/master/pkg/apis/logging/v1/clusterlogging_types.go

### Sample data
- [docs/insights-archive-sample/config/logging/openshift-logging/instance.json](./insights-archive-sample/config/logging/openshift-logging/instance.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.9    | config/logging/{namespace}/{name}.json 		            |

### Config ID
`clusterconfig/openshift_logging`

### Released version
- 4.9

### Backported versions
None

### Notes
None


## OpenshiftMachineAPIEvents

Collects warning ("abnormal") events
from `openshift-machine-api` namespace

### API Reference
None

### Sample data
- [docs/insights-archive-sample/events/openshift-machine-api.json](./insights-archive-sample/events/openshift-machine-api.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.12   | events/openshift-machine-api.json 	                      	|

### Config ID
`clusterconfig/openshift_machine_api_events`

### Released version
- 4.12

### Backported versions
None

### Notes
None


## OpenshiftSDNControllerLogs

collects logs from sdn-controller pod in openshift-sdn namespace with following substrings:
  - "Node %s is not Ready": A node has been set offline for egress IPs because it is reported not ready at API
  - "Node %s may be offline... retrying": An egress node has failed the egress IP health check once,
    so it has big chances to be marked as offline soon or, at the very least, there has been a connectivity glitch.
  - "Node %s is offline": An egress node has failed enough probes to have been marked offline for egress IPs.
    If it has egress CIDRs assigned, its egress IPs have been moved to other nodes.
    Indicates issues at either the node or the network between the master and the node.
  - "Node %s is back online": This indicates that a node has recovered from the condition described
    at the previous message, by starting succeeding the egress IP health checks.
    Useful just in case that previous “Node %s is offline” messages are lost,
    so that we have a clue that there was failure previously.

The Kubernetes API:

	https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48

Response see:

	https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

* Location in archive: config/pod/openshift-sdn/logs/{pod-name}/errors.log
* Id in config: clusterconfig/openshift_sdn_controller_logs
* Since versions:
  - 4.6.21+
  - 4.7+


## OpenshiftSDNLogs

Collects logs from pods in `openshift-sdn` namespace with following substrings:
- "Got OnEndpointsUpdate for unknown Endpoints",
- "Got OnEndpointsDelete for unknown Endpoints",
- "Unable to update proxy firewall for policy",
- "Failed to update proxy firewall for policy",

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
- [docs/insights-archive-sample/config/pod/openshift-sdn/logs/sdn-f2694/errors.log](./insights-archive-sample/config/pod/openshift-sdn/logs/sdn-f2694/errors.log)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.7	   | config/pod/openshift-sdn/logs/{name}/errors.log 			|

### Config ID
`clusterconfig/openshift_sdn_logs`

### Released version
- 4.7

### Backported versions
- 4.6.21+

### Notes
None


## PNCC

Collects a summary of failed PodNetworkConnectivityChecks from last 24 hours.

### API Reference
- podnetworkconnectivitychecks.controlplane.operator.openshift.io/v1alpha1
- https://pkg.go.dev/github.com/openshift/api/operatorcontrolplane/v1alpha1

### Sample data
- [docs/insights-archive-sample/config/podnetworkconnectivitychecks.json](./insights-archive-sample/config/podnetworkconnectivitychecks.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8.2  | config/podnetworkconnectivitychecks.json 					|

### Config ID
`clusterconfig/pod_network_connectivity_checks`

### Released version
- 4.8.2

### Backported versions
None

### Notes
Time of the most recently failed check with each reason and message is recorded.


## PodDefinition

Collects pod definition from pods that are
firing one of the configured alerts.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/conditional/namespaces/openshift-monitoring/pods/alertmanager-main-0/alertmanager-main-0.json](./insights-archive-sample/conditional/namespaces/openshift-monitoring/pods/alertmanager-main-0/alertmanager-main-0.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.11   | conditional/namespaces/{namespace}/pods/{name}/{name}.json |

### Config ID
`conditional/pod_definition`

### Released version
- 4.11

### Backported versions
None

### Notes
None


## PodDisruptionBudgets

Collects the cluster's `PodDisruptionBudgets`.

### API Reference
- https://github.com/kubernetes/client-go/blob/v11.0.0/kubernetes/typed/policy/v1beta1/poddisruptionbudget.go#L80
- https://docs.okd.io/latest/rest_api/policy_apis/poddisruptionbudget-policy-v1beta1.html

### Sample data
- [docs/insights-archive-sample/config/pdbs/openshift-machine-config-operator/etcd-quorum-guard.json](./insights-archive-sample/config/pdbs/openshift-machine-config-operator/etcd-quorum-guard.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
|  >= 4.6   | config/pdbs/{namespace}/{name}.json	                    |

### Config ID
`clusterconfig/pdbs`

### Released version
- 4.6

### Backported versions
- 4.5.15+
- 4.4.30+

### Notes
None


## SAPConfig

Collects selected security context constraints
and cluster role bindings from clusters running a SAP payload.

### API Reference
- https://pkg.go.dev/github.com/openshift/client-go/authorization/clientset/versioned/typed/authorization/v1
- https://pkg.go.dev/github.com/openshift/client-go/security/clientset/versioned/typed/security/v1

### Sample data
- [docs/insights-archive-sample/config/.json](./insights-archive-sample/config/.json)

### Location in archive
| Version   | Path																   |
| --------- | --------------------------------------------------------------------- |
| >= 4.7    | config/{securitycontentconstraint|clusterrolebinding}/{name}.json     |

### Config ID
`clusterconfig/sap_config`

### Released version
- 4.7

### Backported versions
- 4.6.20+

### Notes
**Conditional data**: This data is collected only if the `installers.datahub.sap.com`
resource is found in the cluster.


## SAPDatahubs

Collects `datahubs.installers.datahub.sap.com`
resources from SAP/SDI clusters.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/customresources/installers.datahub.sap.com/datahubs/sdi/default.json](./insights-archive-sample/customresources/installers.datahub.sap.com/datahubs/sdi/default.json)

### Location in archive
| Version   | Path	 			  														 |
| --------- | --------------------------------------------------------------------------- |
| >= 4.8.2  | customresources/installers.datahub.sap.com/datahubs/{namespace}/{name}.json |

### Config ID
`clusterconfig/sap_datahubs`

### Released version
- 4.8.2

### Backported versions
- 4.7.5+
- 4.6.26+

### Notes
None


## SAPPods

Collects information about pods running in SAP/SDI namespaces.

### API Reference
- https://pkg.go.dev/k8s.io/client-go/kubernetes/typed/core/v1
- https://pkg.go.dev/k8s.io/client-go/kubernetes/typed/batch/v1
- https://pkg.go.dev/k8s.io/client-go/dynamic

### Sample data
None

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8.2  | config/pod/{namespace}/{name}.json 					                        |

### Config ID
`clusterconfig/sap_pods`

### Released version
- 4.8.2

### Backported versions
- 4.7.5+
- 4.6.25+

### Notes
- Only pods with a failing status are collected.
- Failed pods belonging to a job that has later succeeded are ignored.
**Conditional data**: This data is collected only if the `installers.datahub.sap.com` resource is found in the cluster.


## SAPVsystemIptablesLogs

Collects logs from SAP `vsystem-iptables` containers
including one from license management pods with the following substring:
  - "can't initialize iptables table",

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
- [docs/insights-archive-sample/config/pod/sdi/logs/license-manager-da1d2e8fadfb8dd7022f08-4hjh7-6887768c5b-qzxb6/errors.log](./insights-archive-sample/config/pod/sdi/logs/license-manager-da1d2e8fadfb8dd7022f08-4hjh7-6887768c5b-qzxb6/errors.log)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.8.2  | config/pod/{namespace}/logs/{pod-name}/errors.log 			|

### Config ID
`clusterconfig/sap_license_management_logs`

### Released version
- 4.8.2

### Backported versions
- 4.7.5+
- 4.6.25+

### Notes
**Conditional data**: This data is collected only if the `installers.datahub.sap.com` resource is found in the cluster.


## SchedulerLogs

Collects logs from pods in `openshift-kube-scheduler-namespace` from app
`openshift-kube-scheduler` with following substring:
- "PodTopologySpread"

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/pod_expansion.go#L48
- https://docs.openshift.com/container-platform/4.6/rest_api/workloads_apis/pod-core-v1.html#apiv1namespacesnamespacepodsnamelog

### Sample data
None

### Location in archive
| Version   | Path															  |
| --------- | ---------------------------------------------------------------- |
| >= 4.10   | config/pod/openshift-kube-scheduler/logs/{pod-name}/messages.log |

### Config ID
`clusterconfig/scheduler_logs`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## Schedulers

Collects information about schedulers

### API Reference
- https://docs.openshift.com/container-platform/4.9/rest_api/config_apis/scheduler-config-openshift-io-v1.html

### Sample data
- [docs/insights-archive-sample/config/schedulers/cluster.json](./insights-archive-sample/config/schedulers/cluster.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/schedulers/cluster.json 					        |

### Config ID
`clusterconfig/schedulers`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## ServiceAccounts

Collects `ServiceAccount` stats
from kubernetes default and namespaces starting with openshift.

### API Reference
- https://github.com/kubernetes/client-go/blob/master/kubernetes/typed/core/v1/serviceaccount.go#L83
- https://docs.openshift.com/container-platform/4.3/rest_api/index.html#serviceaccount-v1-core

### Sample data
- [docs/insights-archive-sample/config/serviceaccounts.json](./insights-archive-sample/config/serviceaccounts.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
|  >= 4.7   | config/serviceaccounts.json		                        |

### Config ID
`clusterconfig/service_accounts`

### Released version
- 4.7

### Backported versions
- 4.6.20+
- 4.5.34+

### Notes
None


## SilencedAlerts

Collects the alerts that have been silenced.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/silenced_alerts.json](./insights-archive-sample/config/silenced_alerts.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/silenced_alerts.json 					            |

### Config ID
`config/silenced_alerts`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## StorageCluster

Collects `storageclusters.ocs.openshift.io` resources

### API Reference
- https://github.com/red-hat-storage/ocs-operator/blob/main/api/v1/storagecluster_types.go

### Sample data
- [docs/insights-archive-sample/config/storage/openshift-storage/storageclusters/ocs-storagecluster.json](./insights-archive-sample/config/storage/openshift-storage/storageclusters/ocs-storagecluster.json)

| Version | Path														|
| ------- | --------------------------------------------------------	|
| <= 4.12 | config/storage/{namespace}/{name}.json 					|
| 4.13+   | config/storage/{namespace}/storageclusters/{name}.json 	|

### Config ID
`clusterconfig/storage_cluster`

### Released version
- 4.11

### Backported versions
None

### Notes
**Changes for >= 4.12**:
- renamed from `OpenshiftStorage` to `StorageCluster`
- config ID changed from `clusterconfig/openshift_storage` to `clusterconfig/storage_cluster`


## SupportSecret

Collects anonymized support secret if there is any

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/secrets/openshift-config/support/data.json](./insights-archive-sample/config/secrets/openshift-config/support/data.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.11   | config/secrets/openshift-config/support/data.json 	        |

### Config ID
`clusterconfig/support_secret`

### Released version
- 4.11

### Backported versions
None

### Notes
None


## TSDBStatus

Collects Prometheus TSDB status.

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/tsdb.json](./insights-archive-sample/config/tsdb.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
| >= 4.10   | config/tsdb.json  			   							    |

### Config ID
`clusterconfig/tsdb_status`

### Released version
- 4.10

### Backported versions
None

### Notes
None


## ValidatingWebhookConfigurations

Collects `ValidatingWebhookConfiguration` resources

### API Reference
- https://docs.openshift.com/container-platform/4.8/rest_api/extension_apis/validatingwebhookconfiguration-admissionregistration-k8s-io-v1.html

### Sample data
- [docs/insights-archive-sample/config/validatingwebhookconfigurations/](./insights-archive-sample/config/validatingwebhookconfigurations/)

### Location in archive
| Version      | Path														|
| ------------ | --------------------------------------------------------	|
|  >= 4.10.13  | config/validatingwebhookconfigurations/{name}.json          |

### Config ID
`clusterconfig/validating_webhook_configurations`

### Released version
- 4.10.13

### Backported versions
- 4.9.11+
- 4.8.24+
- 4.7.40+

### Notes
None


## WorkloadInfo

Collects summarized info about the workloads on a cluster
in a generic fashion

### API Reference
None

### Sample data
- [docs/insights-archive-sample/config/workload_info.json](./insights-archive-sample/config/workload_info.json)

### Location in archive
| Version   | Path														|
| --------- | --------------------------------------------------------	|
|  >= 4.8   | config/workload_info.json      	                        |

### Config ID
`workloads/workload_info`

### Released version
- 4.8

### Backported versions
None

### Notes
None


